<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cit√°tomat ‚Äî PWA</title>

  <!-- PWA META -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#4A90E2">

<!-- Apple ikony -->
<link rel="apple-touch-icon" sizes="192x192" href="/assets/citatomat-icon-192.png">
<link rel="apple-touch-icon" sizes="512x512" href="/assets/citatomat-icon-512.png">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">


<style>
  :root{--bg:#f6f7fb;--card:#fff;--accent:#3b82f6;--muted:#6b7280}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:var(--bg);margin:0;padding:20px;display:flex;align-items:center;justify-content:center;min-height:100vh}
  .app{width:100%;max-width:640px}
  header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
  h1{font-size:1.2rem;margin:0}
  .card{background:var(--card);border-radius:14px;padding:18px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
  #quote{min-height:80px;display:flex;align-items:center;justify-content:center;text-align:center;padding:16px;border-radius:10px;font-size:1.05rem}
  .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  button{border:0;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
  .btn-primary{background:var(--accent);color:#fff}
  .btn-ghost{background:transparent;border:1px solid #e6e9ef;color:var(--muted)}
  .small{font-size:0.9rem;padding:8px 10px}
  .history-list{margin-top:14px;max-height:260px;overflow:auto;padding:8px;display:grid;gap:8px}
  .item{background:#fbfbfe;padding:10px;border-radius:8px;display:flex;justify-content:space-between;align-items:flex-start;gap:8px}
  .item p{margin:0;font-size:0.95rem}
  .item .meta{display:flex;gap:8px}
  .empty{color:var(--muted);text-align:center;padding:18px}
  footer{margin-top:12px;display:flex;gap:10px;justify-content:space-between;align-items:center}
  @media (max-width:420px){#quote{font-size:1rem;padding:12px}}
</style>
</head>
<body>
<div class="app">
  <header>
    <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#ffd6a5,#ffadad);display:flex;align-items:center;justify-content:center;font-weight:700">üò∏</div>
    <div>
      <h1>Cit√°tomat ‚Äî PWA</h1>
      <div style="color:var(--muted);font-size:0.85rem">Generuj ≈°√≠len√© cit√°ty. Ukl√°daj√≠ se do telefonu.</div>
    </div>
  </header>

  <div class="card">
    <div id="quote" aria-live="polite">Klepni na <strong>Generovat</strong>!</div>

    <div class="controls">
      <button id="generate" class="btn-primary">Generovat</button>
      <button id="share" class="btn-ghost">Sd√≠let</button>
      <button id="showHistory" class="btn-ghost">Historie</button>
      <button id="clear" class="small btn-ghost">Smazat historii</button>
    </div>

    <div id="historyPanel" style="display:none;margin-top:12px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <strong>Historie</strong>
        <div style="display:flex;gap:8px">
          <button id="export" class="small btn-ghost">Export .txt</button>
          <button id="closeHistory" class="small btn-ghost">Zav≈ô√≠t</button>
        </div>
      </div>
      <div class="history-list" id="historyList"></div>
      <div id="emptyHint" class="empty" style="display:none">≈Ω√°dn√© cit√°ty zat√≠m ‚Äî generuj!</div>
    </div>

    <footer>
      <div style="color:var(--muted);font-size:0.9rem">Ulo≈æeno v localStorage</div>
      <div style="color:var(--muted);font-size:0.9rem">PWA pro iPhone</div>
    </footer>
  </div>
</div>

<script>
(() => {
  const quotes = [
    "≈Ωivot je jako bonboni√©ra, nikdy nev√≠≈°, co ochutn√°≈°.",
    "Kdo se boj√≠, nesm√≠ do lesa.",
    "Nejlep≈°√≠ pomstou je obrovsk√Ω √∫spƒõch.",
    "Slova jsou zbyteƒçn√°, ƒçiny mluv√≠ hlasitƒõji.",
    "Koƒçka je p√°nem domu, ƒçlovƒõk jen n√°jemn√≠k.",
    "ƒå√≠m v√≠ce v√≠≈°, t√≠m v√≠ce si uvƒõdomuje≈°, ≈æe nic nev√≠≈°.",
    "Kdo chce, hled√° zp≈Øsob. Kdo nechce, hled√° d≈Øvod.",
    "Nen√≠ d≈Øle≈æit√©, kolikr√°t spadne≈°, ale kolikr√°t vstane≈°.",
    "L√©pe b√Ωt chv√≠li bl√°zen ne≈æ cel√Ω ≈æivot idiot.",
    "ƒåas je nejdra≈æ≈°√≠ mƒõna. M≈Ø≈æe≈° ho utratit jen jednou.",
    "Velk√© vƒõci nikdy nevznikly v komfortn√≠ z√≥nƒõ.",
    "Zaƒçni tam, kde jsi. Pou≈æij, co m√°≈°. Dƒõlej, co m≈Ø≈æe≈°.",
    "Neƒçekej na spr√°vn√Ω okam≈æik. Vytvo≈ô si ho.",
    "Ka≈æd√Ω expert byl kdysi zaƒç√°teƒçn√≠k.",
    "Tvoje budoucnost zaƒç√≠n√° teƒè, ne z√≠tra.",
    "Koƒçky nejsou na≈°imi mazl√≠ƒçky. Jsme jejich person√°l.",
    "Tam, kde sp√≠ koƒçka, je domov.",
    "Kdy≈æ mluv√≠ koƒçka, lid√© poslouchaj√≠‚Ä¶ i kdy≈æ nech√°pou.",
    "Koƒçka se nikdy nepon√≠≈æ√≠ t√≠m, ≈æe poslechne.",
    "Jedna koƒçka staƒç√≠ k naplnƒõn√≠ pr√°zdn√©ho bytu ≈°tƒõst√≠m.",
    "Jsem na dietƒõ. Dnes jen pƒõt porc√≠ dortu.",
    "Pr√°ce nen√≠ zaj√≠c. Neuteƒçe. Ale taky se sama neudƒõl√°.",
    "Lep≈°√≠ b√Ωt bl√°zen s √∫smƒõvem ne≈æ g√©nius se ≈æaludem v nose.",
    "Mozek je skvƒõl√° vƒõc. ≈†koda, ≈æe ho lidi nepou≈æ√≠vaj√≠ ƒçastƒõji.",
    "Kdybych mƒõl dolar za ka≈ædou chybu, co jsem udƒõlal, byl bych milion√°≈ô. A po≈ô√°d dƒõlal chyby.",
    "L√°ska nen√≠ o dokonalosti, ale o p≈ôijet√≠.",
    "Skuteƒçn√° l√°ska zaƒç√≠n√° tam, kde konƒç√≠ oƒçek√°v√°n√≠.",
    "L√°ska je jako Wi-Fi ‚Äì siln√°, kdy≈æ jsi bl√≠zko, a obƒças vypad√°v√°.",
    "Koƒçky n√°s uƒç√≠ milovat bez podm√≠nek. A taky, ≈æe nedostane≈° v≈°echno, co chce≈°.",
    "Srdce m√° d≈Øvody, kter√© rozum nezn√°."
  ];

  const LSK = 'citato_history_v1';
  const quoteEl = document.getElementById('quote');
  const genBtn = document.getElementById('generate');
  const shareBtn = document.getElementById('share');
  const histBtn = document.getElementById('showHistory');
  const clearBtn = document.getElementById('clear');
  const historyPanel = document.getElementById('historyPanel');
  const historyList = document.getElementById('historyList');
  const emptyHint = document.getElementById('emptyHint');
  const closeHistory = document.getElementById('closeHistory');
  const exportBtn = document.getElementById('export');

  let history = JSON.parse(localStorage.getItem(LSK) || '[]');
  let current = '';

  function saveHistory() {
    localStorage.setItem(LSK, JSON.stringify(history));
  }

  function renderHistory() {
    historyList.innerHTML = '';
    if(history.length === 0) {
      emptyHint.style.display = 'block';
      return;
    } else {
      emptyHint.style.display = 'none';
    }
    [...history].reverse().forEach(q => {
      const item = document.createElement('div');
      item.className = 'item';
      const p = document.createElement('p');
      p.textContent = q;
      const meta = document.createElement('div');
      meta.className = 'meta';
      const copyBtn = document.createElement('button');
      copyBtn.className = 'small btn-ghost';
      copyBtn.textContent = 'Kop√≠rovat';
      copyBtn.onclick = () => navigator.clipboard?.writeText(q);
      const shareBtnLocal = document.createElement('button');
      shareBtnLocal.className = 'small btn-ghost';
      shareBtnLocal.textContent = 'Sd√≠let';
      shareBtnLocal.onclick = () => doShare(q);
      meta.append(copyBtn, shareBtnLocal);
      item.append(p, meta);
      historyList.appendChild(item);
    });
  }

  function halfCombine(a, b) {
    const half1 = a.slice(0, Math.floor(a.length/2));
    const half2 = b.slice(Math.floor(b.length/2));
    return half1 + half2;
  }

  function generate() {
    if(quotes.length < 2) return;
    const q = halfCombine(
      quotes[Math.floor(Math.random()*quotes.length)],
      quotes[Math.floor(Math.random()*quotes.length)]
    );
    current = q;
    quoteEl.textContent = q;
    history.push(q);
    saveHistory();
  }

  async function doShare(text) {
    if(navigator.share) {
      try {
        await navigator.share({text, title: 'Cit√°tomat'});
      } catch(e){}
    } else if(navigator.clipboard) {
      await navigator.clipboard.writeText(text);
      alert('Cit√°t zkop√≠rov√°n do schr√°nky.');
    }
  }

  genBtn.onclick = generate;
  shareBtn.onclick = () => current && doShare(current);
  histBtn.onclick = () => { renderHistory(); historyPanel.style.display = 'block'; };
  closeHistory.onclick = () => { historyPanel.style.display = 'none'; };
  clearBtn.onclick = () => { if(confirm('Smazat historii?')) { history=[]; saveHistory(); renderHistory(); historyPanel.style.display = 'none'; } };
  exportBtn.onclick = () => {
    if(history.length===0) return alert('≈Ω√°dn√© cit√°ty k exportu.');
    const blob = new Blob([history.join('\n\n')], {type: 'text/plain'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='citato_history.txt';
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  };

  if(history.length) { current = history[history.length-1]; quoteEl.textContent = current; }
})();
</script>

<script>
// Registrace Service Workeru pro PWA
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').then(() => {
    console.log('Service Worker registrov√°n');
  }).catch(err => console.error('SW chyba:', err));
}
</script>
</body>
</html>
